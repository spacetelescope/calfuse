<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--Converted with LaTeX2HTML 97.1 (release) (July 13th, 1997)
 by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippman, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>SLA_AOP - Apparent to Observed</TITLE>
<META NAME="description" CONTENT="SLA_AOP - Apparent to Observed">
<META NAME="keywords" CONTENT="sun67">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso_8859_1">
<LINK REL="STYLESHEET" HREF="sun67.css">
<LINK REL="next" HREF="node21.html">
<LINK REL="previous" HREF="node19.html">
<LINK REL="up" HREF="node13.html">
<LINK REL="next" HREF="node21.html">
</HEAD>
<BODY >
<BR> <HR>
<A NAME="tex2html626" HREF="node21.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html624" HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html618" HREF="node19.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>   <A HREF="sun67.html#stardoccontents"><IMG  ALIGN="BOTTOM" BORDER="0"
 SRC="contents_motif.gif"></A>
<BR>
<B> Next:</B> <A NAME="tex2html627" HREF="node21.html">SLA_AOPPA - Appt-to-Obs Parameters</A>
<BR>
<B>Up:</B> <A NAME="tex2html625" HREF="node13.html">SUBPROGRAM SPECIFICATIONS</A>
<BR>
<B> Previous:</B> <A NAME="tex2html619" HREF="node19.html">SLA_AMPQK - Quick Apparent to Mean</A>
<BR> <HR> <P>
<P><!--End of Navigation Panel-->
<H2><A NAME="SECTION00047000000000000000">SLA_AOP - Apparent to Observed</A>
<A NAME="xref_SLA_AOP">&#160;</A><A NAME="SLA_AOP">&#160;</A>
</H2>
       <DL>
<DT><STRONG>ACTION:</STRONG>
<DD>Apparent to observed place, for optical sources distant from
the solar system.
<P>    <DT><STRONG>CALL:</STRONG>
<DD><TT>CALL sla_AOP (
         RAP, DAP, DATE, DUT, ELONGM, PHIM, HM, XP, YP,
         TDK, PMB, RH, WL, TLR, AOB, ZOB, HOB, DOB, ROB)</TT>
<P>       </DL>
<P>     <DL>
<DT><STRONG>GIVEN:</STRONG>
<DD>
<BR>
<TABLE CELLPADDING=3>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>RAP,DAP</EM></TD>
<TH ALIGN="LEFT"><B>D</B></TH>
<TD ALIGN="LEFT" NOWRAP>geocentric apparent <IMG WIDTH="42" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.gif"
 ALT="$[\,\alpha,\delta\,]$"> (radians)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>DATE</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>UTC date/time (Modified Julian Date, JD-2400000.5)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>DUT</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP><IMG WIDTH="16" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img19.gif"
 ALT="$\Delta$">UT:  UT1-UTC (UTC seconds)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>ELONGM</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>observer's mean longitude (radians, east +ve)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>PHIM</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>observer's mean geodetic latitude (radians)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>HM</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>observer's height above sea level (metres)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>XP,YP</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>polar motion <IMG WIDTH="42" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.gif"
 ALT="$[\,x,y\,]$"> coordinates (radians)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>TDK</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>local ambient temperature (degrees K; std=273.155D0)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>PMB</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>local atmospheric pressure (mB; std=1013.25D0)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>RH</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>local relative humidity (in the range 0D0-1D0)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>WL</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>effective wavelength (<IMG WIDTH="26" HEIGHT="25" ALIGN="MIDDLE" BORDER="0"
 SRC="img21.gif"
 ALT="$\mu{\rm m}$">, <I>e.g.</I> 0.55D0)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>TLR</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>tropospheric lapse rate (degrees K per metre,
<I>e.g.</I> 0.0065D0)</TD>
</TR>
</TABLE></DL>
<P>     <DL>
<DT><STRONG>RETURNED:</STRONG>
<DD>
<BR>
<TABLE CELLPADDING=3>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>AOB</EM></TD>
<TH ALIGN="LEFT"><B>D</B></TH>
<TD ALIGN="LEFT" NOWRAP>observed azimuth (radians: N=0, E=<IMG WIDTH="26" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif"
 ALT="$90^{\circ}$">)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>ZOB</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>observed zenith distance (radians)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>HOB</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>observed Hour Angle (radians)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>DOB</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>observed <IMG WIDTH="10" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img23.gif"
 ALT="$\delta$"> (radians)</TD>
</TR>
<TR VALIGN="TOP"><TD ALIGN="LEFT"><EM>ROB</EM></TD>
<TD ALIGN="LEFT"><B>D</B></TD>
<TD ALIGN="LEFT" NOWRAP>observed <IMG WIDTH="13" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img24.gif"
 ALT="$\alpha$"> (radians)</TD>
</TR>
</TABLE></DL>
<P>      <DL>
<DT><STRONG>NOTES:</STRONG>
<DD><DL COMPACT>
<DT>1.
<DD>This routine returns zenith distance rather than elevation
in order to reflect the fact that no allowance is made for
depression of the horizon.
  <DT>2.
<DD>The accuracy of the result is limited by the corrections for
        refraction.  Providing the meteorological parameters are
        known accurately and there are no gross local effects, the
        predicted azimuth and elevation should be within about
<P>      <IMG WIDTH="23" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img25.gif"
 ALT="$0\hspace{-0.05em}^{'\hspace{-0.1em}'}\hspace{-0.4em}.1$">    for <IMG WIDTH="56" HEIGHT="27" ALIGN="MIDDLE" BORDER="0"
 SRC="img26.gif"
 ALT="$\zeta<70^{\circ}$">.  Even
        at a topocentric zenith distance of
        <IMG WIDTH="26" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.gif"
 ALT="$90^{\circ}$">, the accuracy in elevation should be better than
        1&nbsp;arcminute;  useful results are available for a further
        <IMG WIDTH="18" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img27.gif"
 ALT="$3^{\circ}$">, beyond which the sla_REFRO routine returns a
        fixed value of the refraction.  The complementary
        routines sla_AOP (or sla_AOPQK) and sla_OAP (or sla_OAPQK)
        are self-consistent to better than 1&nbsp;microarcsecond all over
        the celestial sphere.
  <DT>3.
<DD>It is advisable to take great care with units, as even
        unlikely values of the input parameters are accepted and
        processed in accordance with the models used.
  <DT>4.
<DD><I>Apparent</I> <IMG WIDTH="42" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.gif"
 ALT="$[\,\alpha,\delta\,]$"> means the geocentric apparent right ascension
        and declination, which is obtained from a catalogue mean place
        by allowing for space motion, parallax, precession, nutation,
        annual aberration, and the Sun's gravitational lens effect.  For
        star positions in the FK5 system (<I>i.e.</I> J2000), these effects can
        be applied by means of the sla_MAP <I>etc.</I> routines.  Starting from
        other mean place systems, additional transformations will be
        needed;  for example, FK4 (<I>i.e.</I> B1950) mean places would first
        have to be converted to FK5, which can be done with the
        sla_FK425 <I>etc.</I> routines.
  <DT>5.
<DD><I>Observed</I> <IMG WIDTH="66" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.gif"
 ALT="$[\,Az,El~]$"> means the position that would be seen by a
        perfect theodolite located at the observer.  This is obtained
        from the geocentric apparent <IMG WIDTH="42" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.gif"
 ALT="$[\,\alpha,\delta\,]$"> by allowing for Earth
        orientation and diurnal aberration, rotating from equator
        to horizon coordinates, and then adjusting for refraction.
        The <IMG WIDTH="41" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img29.gif"
 ALT="$[\,h,\delta\,]$"> is obtained by rotating back into equatorial
        coordinates, using the geodetic latitude corrected for polar
        motion, and is the position that would be seen by a perfect
        equatorial located at the observer and with its polar axis
        aligned to the Earth's axis of rotation (<I>n.b.</I> not to the
        refracted pole).  Finally, the <IMG WIDTH="13" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img24.gif"
 ALT="$\alpha$"> is obtained by subtracting
        the <I>h</I> from the local apparent ST.
  <DT>6.
<DD>To predict the required setting of a real telescope, the
        observed place produced by this routine would have to be
        adjusted for the tilt of the azimuth or polar axis of the
        mounting (with appropriate corrections for mount flexures),
        for non-perpendicularity between the mounting axes, for the
        position of the rotator axis and the pointing axis relative
        to it, for tube flexure, for gear and encoder errors, and
        finally for encoder zero points.  Some telescopes would, of
        course, exhibit other properties which would need to be
        accounted for at the appropriate point in the sequence.
  <DT>7.
<DD>This routine takes time to execute, due mainly to the
        rigorous integration used to evaluate the refraction.
        For processing multiple stars for one location and time,
        call sla_AOPPA once followed by one call per star to sla_AOPQK.
        Where a range of times within a limited period of a few hours
        is involved, and the highest precision is not required, call
        sla_AOPPA once, followed by a call to sla_AOPPAT each time the
        time changes, followed by one call per star to sla_AOPQK.
  <DT>8.
<DD>The DATE argument is UTC expressed as an MJD.  This is,
        strictly speaking, wrong, because of leap seconds.  However,
        as long as the <IMG WIDTH="16" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img19.gif"
 ALT="$\Delta$">UT and the UTC are consistent there
        are no difficulties, except during a leap second.  In this
        case, the start of the 61st second of the final minute should
        begin a new MJD day and the old pre-leap <IMG WIDTH="16" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img19.gif"
 ALT="$\Delta$">UT should
        continue to be used.  As the 61st second completes, the MJD
        should revert to the start of the day as, simultaneously,
        the <IMG WIDTH="16" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img19.gif"
 ALT="$\Delta$">UT changes by one second to its post-leap new value.
  <DT>9.
<DD>The <IMG WIDTH="16" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img19.gif"
 ALT="$\Delta$">UT (UT1-UTC) is tabulated in IERS circulars and
        elsewhere.  It increases by exactly one second at the end of
        each UTC leap second, introduced in order to keep <IMG WIDTH="16" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img19.gif"
 ALT="$\Delta$">UT
        within <IMG WIDTH="15" HEIGHT="25" ALIGN="MIDDLE" BORDER="0"
 SRC="img30.gif"
 ALT="$\pm$"><IMG WIDTH="24" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img31.gif"
 ALT="$0^{\rm s}\hspace{-0.3em}.9$">.  <DT>10.
<DD>IMPORTANT - TAKE CARE WITH THE LONGITUDE SIGN CONVENTION.  The
        longitude required by the present routine is <B>east-positive</B>,
        in accordance with geographical convention (and right-handed).
        In particular, note that the longitudes returned by the
        sla_OBS routine are west-positive (as in the <I>Astronomical
        Almanac</I> before 1984) and must be reversed in sign before use
        in the present routine.
  <DT>11.
<DD>The polar coordinates XP,YP can be obtained from IERS
        circulars and equivalent publications.  The
        maximum amplitude is about 
      <IMG WIDTH="23" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img32.gif"
 ALT="$0\hspace{-0.05em}^{'\hspace{-0.1em}'}\hspace{-0.4em}.3$">   .  If XP,YP values
        are unavailable, use XP=YP=0D0.  See page B60 of the 1988
        <I>Astronomical Almanac</I> for a definition of the two angles.
  <DT>12.
<DD>The height above sea level of the observing station, HM,
        can be obtained from the <I>Astronomical Almanac</I> (Section J
        in the 1988 edition), or via the routine sla_OBS.  If P,
        the pressure in mB, is available, an adequate
        estimate of HM can be obtained from the following expression:
        <BLOCKQUOTE><TT>HM=-29.3D0*TSL*LOG(P/1013.25D0)</TT>
        </BLOCKQUOTE>
        where TSL is the approximate sea-level air temperature in degrees K
        (see <I>Astrophysical Quantities</I>, C.W.Allen, 3rd&nbsp;edition,
        &#167;52).  Similarly, if the pressure P is not known,
        it can be estimated from the height of the observing
        station, HM as follows:
        <BLOCKQUOTE><TT>P=1013.25D0*EXP(-HM/(29.3D0*TSL))</TT>
        </BLOCKQUOTE>
        Note, however, that the refraction is proportional to the
        pressure and that an accurate P value is important for
        precise work.
  <DT>13.
<DD>The azimuths <I>etc.</I> used by the present routine are with
        respect to the celestial pole.  Corrections to the terrestrial pole
        can be computed using sla_POLMO.
 </DL></DL>
<BR> <HR>
<A NAME="tex2html626" HREF="node21.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html624" HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html618" HREF="node19.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>   <A HREF="sun67.html#stardoccontents"><IMG  ALIGN="BOTTOM" BORDER="0"
 SRC="contents_motif.gif"></A>
<BR>
<B> Next:</B> <A NAME="tex2html627" HREF="node21.html">SLA_AOPPA - Appt-to-Obs Parameters</A>
<BR>
<B>Up:</B> <A NAME="tex2html625" HREF="node13.html">SUBPROGRAM SPECIFICATIONS</A>
<BR>
<B> Previous:</B> <A NAME="tex2html619" HREF="node19.html">SLA_AMPQK - Quick Apparent to Mean</A>
<BR> <HR> <P>
<P><!--End of Navigation Panel-->
<ADDRESS>
<I>SLALIB --- Positional Astronomy Library<BR>Starlink User Note 67<BR>P. T. Wallace<BR>12 October 1999<BR>E-mail:ptw@star.rl.ac.uk</I>
</ADDRESS>
</BODY>
</HTML>
